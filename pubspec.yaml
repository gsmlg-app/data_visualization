name: data_visualization_workspace
publish_to: none

environment:
  sdk: ">=3.8.0 <4.0.0"

workspace:
  - packages/dv_vendor
  - packages/dv_point
  - packages/dv_scale
  - packages/dv_curve
  - packages/dv_geo_core
  - packages/dv_delaunay
  - packages/dv_voronoi
  - packages/dv_stats
  - packages/dv_hierarchy
  - packages/dv_group
  - packages/dv_shape
  - packages/dv_glyph
  - packages/dv_gradient
  - packages/dv_pattern
  - packages/dv_clip_path
  - packages/dv_marker
  - packages/dv_text
  - packages/dv_axis
  - packages/dv_grid
  - packages/dv_legend
  - packages/dv_annotation
  - packages/dv_geo
  - packages/dv_event
  - packages/dv_tooltip
  - packages/dv_brush
  - packages/dv_drag
  - packages/dv_zoom
  - packages/dv_bounds
  - packages/dv_responsive
  - packages/dv_xychart
  - packages/dv_heatmap
  - packages/dv_network
  - packages/dv_threshold
  - packages/dv_mock_data
  - packages/data_visualization
  - examples/showcase_app
  - examples/pages

dev_dependencies:
  melos: ^7.0.0

melos:
  name: data_visualization
  repository: https://github.com/gsmlg-dev/data_visualization
  packages:
    - packages/**
    - examples/**

  versioning:
    mode: independent
    updateDependentsConstraints: true

  command:
    version:
      includeCommitId: false
      linkToCommits: true
      workspaceChangelog: true
      branch: main
      message: |
        chore(release): publish packages

        {new_package_versions}
    publish:
      hooks:
        pre: melos run prepare

  scripts:
    prepare:
      run: melos bootstrap
      description: Bootstrap the workspace

    analyze:
      exec: dart analyze
      description: Run dart analyze on all packages

    test:
      exec: flutter test
      description: Run tests on all packages
      packageFilters:
        dirExists: test

    format:
      exec: dart format .
      description: Format all packages

    format-check:
      exec: dart format --set-exit-if-changed .
      description: Check formatting of all packages

    version:patch:
      run: melos version --yes --no-git-tag-version patch
      description: Bump patch version for all changed packages

    version:minor:
      run: melos version --yes --no-git-tag-version minor
      description: Bump minor version for all changed packages

    version:major:
      run: melos version --yes --no-git-tag-version major
      description: Bump major version for all changed packages

    publish:
      run: melos publish --yes --no-dry-run
      description: Publish all packages to pub.dev
      packageFilters:
        noPrivate: true

    publish:dry-run:
      run: melos publish --yes
      description: Dry run publish to check for issues
      packageFilters:
        noPrivate: true
